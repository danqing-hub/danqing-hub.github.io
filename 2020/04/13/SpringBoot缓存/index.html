<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>SpringBoot缓存 | DanqingBlog</title><meta name="description" content="SpringBoot缓存的介绍，包含原理、搭建web环境、缓存注解"><meta name="keywords" content="缓存"><meta name="author" content="Danqing"><meta name="copyright" content="Danqing"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="SpringBoot缓存"><meta name="twitter:description" content="SpringBoot缓存的介绍，包含原理、搭建web环境、缓存注解"><meta name="twitter:image" content="https://gitee.com/danqing-hub/images/raw/master/springboot.jpg"><meta property="og:type" content="article"><meta property="og:title" content="SpringBoot缓存"><meta property="og:url" content="http://yoursite.com/2020/04/13/SpringBoot%E7%BC%93%E5%AD%98/"><meta property="og:site_name" content="DanqingBlog"><meta property="og:description" content="SpringBoot缓存的介绍，包含原理、搭建web环境、缓存注解"><meta property="og:image" content="https://gitee.com/danqing-hub/images/raw/master/springboot.jpg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'true'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.15/dist/snackbar.min.css"><link rel="canonical" href="http://yoursite.com/2020/04/13/SpringBoot%E7%BC%93%E5%AD%98/"><link rel="prev" title="班级管理系统(SSM+LayUI)" href="http://yoursite.com/2020/04/17/%E7%8F%AD%E7%BA%A7%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F(SSM+LayUI)/"><link rel="next" title="ajax成功请求到后台，但是前端报404错误" href="http://yoursite.com/2020/02/07/ajax%E6%88%90%E5%8A%9F%E8%AF%B7%E6%B1%82%E5%88%B0%E5%90%8E%E5%8F%B0%EF%BC%8C%E4%BD%86%E6%98%AF%E5%89%8D%E7%AB%AF%E6%8A%A5404%E9%94%99%E8%AF%AF/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  highlight_copy: 'true',
  highlight_lang: 'true',
  highlight_shrink: 'false',
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  copyright: undefined,
  copy_copyright_js: false,
  ClickShowText: undefined,
  medium_zoom: 'false',
  Snackbar: {"bookmark":{"title":"Snackbar.bookmark.title","message_prev":"按","message_next":"键将本页加入书签"},"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"}
  
}</script></head><body><div id="header"> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">DanqingBlog</a></span><i class="fa fa-bars fa-fw toggle-menu pull_right close" aria-hidden="true"></i><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 列表</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 视频</span></a></li></ul></div></div></span><span class="pull_right" id="search_button"></span></div></div><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="lazyload avatar_img" src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/Photo/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'"></div><div class="mobile_post_data"><div class="mobile_data_item is_center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">16</div></a></div></div><div class="mobile_data_item is_center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">14</div></a></div></div><div class="mobile_data_item is_center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">13</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 列表</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 视频</span></a></li></ul></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#ONE、搭建web环境"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">ONE、搭建web环境</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#一、创建javabean封装数据"><span class="toc_mobile_items-number">1.1.</span> <span class="toc_mobile_items-text">一、创建javabean封装数据</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#二、整合Mybatis操作数据库"><span class="toc_mobile_items-number">1.2.</span> <span class="toc_mobile_items-text">二、整合Mybatis操作数据库</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-配置数据源"><span class="toc_mobile_items-number">1.2.1.</span> <span class="toc_mobile_items-text">1.配置数据源</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-使用注解版的Mybatis；"><span class="toc_mobile_items-number">1.2.2.</span> <span class="toc_mobile_items-text">2.使用注解版的Mybatis；</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#3-测试"><span class="toc_mobile_items-number">1.2.3.</span> <span class="toc_mobile_items-text">3.测试</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#4-业务层"><span class="toc_mobile_items-number">1.2.4.</span> <span class="toc_mobile_items-text">4.业务层</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#5-表现层"><span class="toc_mobile_items-number">1.2.5.</span> <span class="toc_mobile_items-text">5.表现层</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#6-测试"><span class="toc_mobile_items-number">1.2.6.</span> <span class="toc_mobile_items-text">6.测试</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#（1）开启驼峰命名规则"><span class="toc_mobile_items-number">1.2.6.1.</span> <span class="toc_mobile_items-text">（1）开启驼峰命名规则</span></a></li></ol></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#TWO、快速体验缓存"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text">TWO、快速体验缓存</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#一、步骤"><span class="toc_mobile_items-number">2.1.</span> <span class="toc_mobile_items-text">一、步骤</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-开启基于注解的缓存"><span class="toc_mobile_items-number">2.1.1.</span> <span class="toc_mobile_items-text">1.开启基于注解的缓存</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-标注缓存注解即可"><span class="toc_mobile_items-number">2.1.2.</span> <span class="toc_mobile_items-text">2.标注缓存注解即可</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#3-验证缓存生效"><span class="toc_mobile_items-number">2.1.3.</span> <span class="toc_mobile_items-text">3.验证缓存生效</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#二、缓存原理"><span class="toc_mobile_items-number">2.2.</span> <span class="toc_mobile_items-text">二、缓存原理</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#THREE、缓存注解"><span class="toc_mobile_items-number">3.</span> <span class="toc_mobile_items-text">THREE、缓存注解</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#一、-Cacheable"><span class="toc_mobile_items-number">3.1.</span> <span class="toc_mobile_items-text">一、@Cacheable</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-cacheNames-value"><span class="toc_mobile_items-number">3.1.1.</span> <span class="toc_mobile_items-text">1.cacheNames/value</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-key-缓存数据使用的key"><span class="toc_mobile_items-number">3.1.2.</span> <span class="toc_mobile_items-text">2.key:缓存数据使用的key</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#3-keyGenerator"><span class="toc_mobile_items-number">3.1.3.</span> <span class="toc_mobile_items-text">3.keyGenerator</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#4-cacheManager"><span class="toc_mobile_items-number">3.1.4.</span> <span class="toc_mobile_items-text">4. cacheManager</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#5-condition"><span class="toc_mobile_items-number">3.1.5.</span> <span class="toc_mobile_items-text">5.condition</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#6-unless"><span class="toc_mobile_items-number">3.1.6.</span> <span class="toc_mobile_items-text">6.unless</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#7-sync"><span class="toc_mobile_items-number">3.1.7.</span> <span class="toc_mobile_items-text">7.sync</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#二、-CachePut"><span class="toc_mobile_items-number">3.2.</span> <span class="toc_mobile_items-text">二、@CachePut</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-在需要的方法上添加注解"><span class="toc_mobile_items-number">3.2.1.</span> <span class="toc_mobile_items-text">1.在需要的方法上添加注解</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-测试"><span class="toc_mobile_items-number">3.2.2.</span> <span class="toc_mobile_items-text">2.测试</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#（1）查询1号员工，并把查询的结果放到缓存中"><span class="toc_mobile_items-number">3.2.2.1.</span> <span class="toc_mobile_items-text">（1）查询1号员工，并把查询的结果放到缓存中</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#（2）再次查询1号员工"><span class="toc_mobile_items-number">3.2.2.2.</span> <span class="toc_mobile_items-text">（2）再次查询1号员工</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#（3）更新1号员工"><span class="toc_mobile_items-number">3.2.2.3.</span> <span class="toc_mobile_items-text">（3）更新1号员工</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#（4）第三次查询1号员工"><span class="toc_mobile_items-number">3.2.2.4.</span> <span class="toc_mobile_items-text">（4）第三次查询1号员工</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#3-为什么没有查到更新后的数据？？？"><span class="toc_mobile_items-number">3.2.3.</span> <span class="toc_mobile_items-text">3.为什么没有查到更新后的数据？？？</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#4-解决方法"><span class="toc_mobile_items-number">3.2.4.</span> <span class="toc_mobile_items-text">4.解决方法</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#（1）更新的key和查询的key应该一致"><span class="toc_mobile_items-number">3.2.4.1.</span> <span class="toc_mobile_items-text">（1）更新的key和查询的key应该一致</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#（2）也可以用返回值"><span class="toc_mobile_items-number">3.2.4.2.</span> <span class="toc_mobile_items-text">（2）也可以用返回值</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#5-再次测试"><span class="toc_mobile_items-number">3.2.5.</span> <span class="toc_mobile_items-text">5.再次测试</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#（1）查询1号员工"><span class="toc_mobile_items-number">3.2.5.1.</span> <span class="toc_mobile_items-text">（1）查询1号员工</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#（2）再次查询1号员工-1"><span class="toc_mobile_items-number">3.2.5.2.</span> <span class="toc_mobile_items-text">（2）再次查询1号员工</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#（3）更新1号员工-1"><span class="toc_mobile_items-number">3.2.5.3.</span> <span class="toc_mobile_items-text">（3）更新1号员工</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#（4）第三次查询1号员工-1"><span class="toc_mobile_items-number">3.2.5.4.</span> <span class="toc_mobile_items-text">（4）第三次查询1号员工</span></a></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#三、-CacheEvict"><span class="toc_mobile_items-number">3.3.</span> <span class="toc_mobile_items-text">三、@CacheEvict</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-在-EmployeeService里添加相应的方法"><span class="toc_mobile_items-number">3.3.1.</span> <span class="toc_mobile_items-text">1.在 EmployeeService里添加相应的方法</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-在-EmployeeController里添加相应的方法"><span class="toc_mobile_items-number">3.3.2.</span> <span class="toc_mobile_items-text">2.在 EmployeeController里添加相应的方法</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#3-测试-1"><span class="toc_mobile_items-number">3.3.3.</span> <span class="toc_mobile_items-text">3.测试</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#4-属性"><span class="toc_mobile_items-number">3.3.4.</span> <span class="toc_mobile_items-text">4.属性</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#（1）key"><span class="toc_mobile_items-number">3.3.4.1.</span> <span class="toc_mobile_items-text">（1）key</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#（2）allEntries"><span class="toc_mobile_items-number">3.3.4.2.</span> <span class="toc_mobile_items-text">（2）allEntries</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#（3）beforeInvocation"><span class="toc_mobile_items-number">3.3.4.3.</span> <span class="toc_mobile_items-text">（3）beforeInvocation</span></a></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#四、-Caching"><span class="toc_mobile_items-number">3.4.</span> <span class="toc_mobile_items-text">四、@Caching</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-在EmployeeService中写如下方法"><span class="toc_mobile_items-number">3.4.1.</span> <span class="toc_mobile_items-text">1.在EmployeeService中写如下方法</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-在EmployeeController中添加如下方法"><span class="toc_mobile_items-number">3.4.2.</span> <span class="toc_mobile_items-text">2.在EmployeeController中添加如下方法</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#3-在EmployeeMapper中写如下方法"><span class="toc_mobile_items-number">3.4.3.</span> <span class="toc_mobile_items-text">3.在EmployeeMapper中写如下方法</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#4-测试"><span class="toc_mobile_items-number">3.4.4.</span> <span class="toc_mobile_items-text">4.测试</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#五、-CacheConfig"><span class="toc_mobile_items-number">3.5.</span> <span class="toc_mobile_items-text">五、@CacheConfig</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-cacheName"><span class="toc_mobile_items-number">3.5.1.</span> <span class="toc_mobile_items-text">1.cacheName</span></a></li></ol></li></ol></li></ol></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ONE、搭建web环境"><span class="toc-number">1.</span> <span class="toc-text">ONE、搭建web环境</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#一、创建javabean封装数据"><span class="toc-number">1.1.</span> <span class="toc-text">一、创建javabean封装数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、整合Mybatis操作数据库"><span class="toc-number">1.2.</span> <span class="toc-text">二、整合Mybatis操作数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-配置数据源"><span class="toc-number">1.2.1.</span> <span class="toc-text">1.配置数据源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-使用注解版的Mybatis；"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.使用注解版的Mybatis；</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-测试"><span class="toc-number">1.2.3.</span> <span class="toc-text">3.测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-业务层"><span class="toc-number">1.2.4.</span> <span class="toc-text">4.业务层</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-表现层"><span class="toc-number">1.2.5.</span> <span class="toc-text">5.表现层</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-测试"><span class="toc-number">1.2.6.</span> <span class="toc-text">6.测试</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#（1）开启驼峰命名规则"><span class="toc-number">1.2.6.1.</span> <span class="toc-text">（1）开启驼峰命名规则</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#TWO、快速体验缓存"><span class="toc-number">2.</span> <span class="toc-text">TWO、快速体验缓存</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#一、步骤"><span class="toc-number">2.1.</span> <span class="toc-text">一、步骤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-开启基于注解的缓存"><span class="toc-number">2.1.1.</span> <span class="toc-text">1.开启基于注解的缓存</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-标注缓存注解即可"><span class="toc-number">2.1.2.</span> <span class="toc-text">2.标注缓存注解即可</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-验证缓存生效"><span class="toc-number">2.1.3.</span> <span class="toc-text">3.验证缓存生效</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、缓存原理"><span class="toc-number">2.2.</span> <span class="toc-text">二、缓存原理</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#THREE、缓存注解"><span class="toc-number">3.</span> <span class="toc-text">THREE、缓存注解</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#一、-Cacheable"><span class="toc-number">3.1.</span> <span class="toc-text">一、@Cacheable</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-cacheNames-value"><span class="toc-number">3.1.1.</span> <span class="toc-text">1.cacheNames/value</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-key-缓存数据使用的key"><span class="toc-number">3.1.2.</span> <span class="toc-text">2.key:缓存数据使用的key</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-keyGenerator"><span class="toc-number">3.1.3.</span> <span class="toc-text">3.keyGenerator</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-cacheManager"><span class="toc-number">3.1.4.</span> <span class="toc-text">4. cacheManager</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-condition"><span class="toc-number">3.1.5.</span> <span class="toc-text">5.condition</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-unless"><span class="toc-number">3.1.6.</span> <span class="toc-text">6.unless</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-sync"><span class="toc-number">3.1.7.</span> <span class="toc-text">7.sync</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、-CachePut"><span class="toc-number">3.2.</span> <span class="toc-text">二、@CachePut</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-在需要的方法上添加注解"><span class="toc-number">3.2.1.</span> <span class="toc-text">1.在需要的方法上添加注解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-测试"><span class="toc-number">3.2.2.</span> <span class="toc-text">2.测试</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#（1）查询1号员工，并把查询的结果放到缓存中"><span class="toc-number">3.2.2.1.</span> <span class="toc-text">（1）查询1号员工，并把查询的结果放到缓存中</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#（2）再次查询1号员工"><span class="toc-number">3.2.2.2.</span> <span class="toc-text">（2）再次查询1号员工</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#（3）更新1号员工"><span class="toc-number">3.2.2.3.</span> <span class="toc-text">（3）更新1号员工</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#（4）第三次查询1号员工"><span class="toc-number">3.2.2.4.</span> <span class="toc-text">（4）第三次查询1号员工</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-为什么没有查到更新后的数据？？？"><span class="toc-number">3.2.3.</span> <span class="toc-text">3.为什么没有查到更新后的数据？？？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-解决方法"><span class="toc-number">3.2.4.</span> <span class="toc-text">4.解决方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#（1）更新的key和查询的key应该一致"><span class="toc-number">3.2.4.1.</span> <span class="toc-text">（1）更新的key和查询的key应该一致</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#（2）也可以用返回值"><span class="toc-number">3.2.4.2.</span> <span class="toc-text">（2）也可以用返回值</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-再次测试"><span class="toc-number">3.2.5.</span> <span class="toc-text">5.再次测试</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#（1）查询1号员工"><span class="toc-number">3.2.5.1.</span> <span class="toc-text">（1）查询1号员工</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#（2）再次查询1号员工-1"><span class="toc-number">3.2.5.2.</span> <span class="toc-text">（2）再次查询1号员工</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#（3）更新1号员工-1"><span class="toc-number">3.2.5.3.</span> <span class="toc-text">（3）更新1号员工</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#（4）第三次查询1号员工-1"><span class="toc-number">3.2.5.4.</span> <span class="toc-text">（4）第三次查询1号员工</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三、-CacheEvict"><span class="toc-number">3.3.</span> <span class="toc-text">三、@CacheEvict</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-在-EmployeeService里添加相应的方法"><span class="toc-number">3.3.1.</span> <span class="toc-text">1.在 EmployeeService里添加相应的方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-在-EmployeeController里添加相应的方法"><span class="toc-number">3.3.2.</span> <span class="toc-text">2.在 EmployeeController里添加相应的方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-测试-1"><span class="toc-number">3.3.3.</span> <span class="toc-text">3.测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-属性"><span class="toc-number">3.3.4.</span> <span class="toc-text">4.属性</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#（1）key"><span class="toc-number">3.3.4.1.</span> <span class="toc-text">（1）key</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#（2）allEntries"><span class="toc-number">3.3.4.2.</span> <span class="toc-text">（2）allEntries</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#（3）beforeInvocation"><span class="toc-number">3.3.4.3.</span> <span class="toc-text">（3）beforeInvocation</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#四、-Caching"><span class="toc-number">3.4.</span> <span class="toc-text">四、@Caching</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-在EmployeeService中写如下方法"><span class="toc-number">3.4.1.</span> <span class="toc-text">1.在EmployeeService中写如下方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-在EmployeeController中添加如下方法"><span class="toc-number">3.4.2.</span> <span class="toc-text">2.在EmployeeController中添加如下方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-在EmployeeMapper中写如下方法"><span class="toc-number">3.4.3.</span> <span class="toc-text">3.在EmployeeMapper中写如下方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-测试"><span class="toc-number">3.4.4.</span> <span class="toc-text">4.测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#五、-CacheConfig"><span class="toc-number">3.5.</span> <span class="toc-text">五、@CacheConfig</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-cacheName"><span class="toc-number">3.5.1.</span> <span class="toc-text">1.cacheName</span></a></li></ol></li></ol></li></ol></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://gitee.com/danqing-hub/images/raw/master/java.jpg)"><div id="post-info"><div id="post-title"><div class="posttitle">SpringBoot缓存</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2020-04-13<span class="post-meta__separator">|</span><i class="fa fa-history" aria-hidden="true"></i> 更新于 2020-04-17</time><span class="post-meta__separator mobile_hidden">|</span><span class="mobile_hidden"><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/SpringBoot/">SpringBoot</a></span><div class="post-meta-wordcount"><i class="fa fa-file-word-o post-meta__icon" aria-hidden="true"></i><span>字数总计: </span><span class="word-count">3.8k</span><span class="post-meta__separator">|</span><i class="fa fa-clock-o post-meta__icon" aria-hidden="true"></i><span>阅读时长: 15 分钟</span><span class="post-meta__separator">|</span><i class="fa fa-eye post-meta__icon" aria-hidden="true">       </i><span>阅读量: </span><span id="busuanzi_value_page_pv"></span></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h1 id="ONE、搭建web环境"><a href="#ONE、搭建web环境" class="headerlink" title="ONE、搭建web环境"></a>ONE、搭建web环境</h1><ul>
<li><p>使用springboot初始化器创建一个项目<br><img alt="b5347e4fc283a7effa11ae1f57d6e6f4.png" data-src="http://gitee.com/danqing-hub/images/raw/master/b5347e4fc283a7effa11ae1f57d6e6f4.png" class="lazyload"></p>
</li>
<li><p>选择抽象的缓存模块<br><img alt="cab0c56fcba00a16a7f77f412ff9d467.png" data-src="http://gitee.com/danqing-hub/images/raw/master/cab0c56fcba00a16a7f77f412ff9d467.png" class="lazyload"></p>
</li>
<li><p>所有需要选择的模块：</p>
</li>
</ul>
<p><img alt="98a7d018149e51ac2e4dcfa929289b02.png" data-src="https://gitee.com/danqing-hub/images/raw/master/98a7d018149e51ac2e4dcfa929289b02.png" class="lazyload"></p>
<ul>
<li>创建需要的数据库<br><img alt="03d94b1158905dbdb820332eaaaaf2e9.png" data-src="https://gitee.com/danqing-hub/images/raw/master/03d94b1158905dbdb820332eaaaaf2e9.png" class="lazyload"></li>
</ul>
<p><strong>在数据库里创建一些表</strong></p>
<ul>
<li><p>department表<br><img alt="a40708612755cf8514d56c355cd1edde.png" data-src="https://gitee.com/danqing-hub/images/raw/master/a40708612755cf8514d56c355cd1edde.png" class="lazyload"></p>
</li>
<li><p>employee表<br><img alt="96febadafe58de643199808b3fee4c9f.png" data-src="https://gitee.com/danqing-hub/images/raw/master/96febadafe58de643199808b3fee4c9f.png" class="lazyload"></p>
</li>
</ul>
<h2 id="一、创建javabean封装数据"><a href="#一、创建javabean封装数据" class="headerlink" title="一、创建javabean封装数据"></a>一、创建javabean封装数据</h2><ul>
<li>创建一个bean包，创建javabean封装数据库里的数据</li>
</ul>
<p><strong>里面包括有参构造器、无参构造器、toString方法和getter和setter</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Employee</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String lastName;;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">    <span class="keyword">private</span> Integer gender;<span class="comment">//性别 1男 0女</span></span><br><span class="line">    <span class="keyword">private</span> Integer dId;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Employee&#123;"</span> +</span><br><span class="line">                <span class="string">"id="</span> + id +</span><br><span class="line">                <span class="string">", lastName='"</span> + lastName + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", email='"</span> + email + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", gender="</span> + gender +</span><br><span class="line">                <span class="string">", dId="</span> + dId +</span><br><span class="line">                <span class="string">'&#125;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Employee</span><span class="params">(Integer id, String lastName, String email, Integer gender, Integer dId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">        <span class="keyword">this</span>.lastName = lastName;</span><br><span class="line">        <span class="keyword">this</span>.email = email;</span><br><span class="line">        <span class="keyword">this</span>.gender = gender;</span><br><span class="line">        <span class="keyword">this</span>.dId = dId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Employee</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getLastName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> lastName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLastName</span><span class="params">(String lastName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.lastName = lastName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getEmail</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> email;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEmail</span><span class="params">(String email)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.email = email;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getGender</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> gender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setGender</span><span class="params">(Integer gender)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.gender = gender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getdId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> dId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setdId</span><span class="params">(Integer dId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.dId = dId;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Department</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String departmentName;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDepartmentName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> departmentName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDepartmentName</span><span class="params">(String departmentName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.departmentName = departmentName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Department</span><span class="params">(Integer id, String departmentName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">        <span class="keyword">this</span>.departmentName = departmentName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Department</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Department&#123;"</span> +</span><br><span class="line">                <span class="string">"id="</span> + id +</span><br><span class="line">                <span class="string">", departmentName='"</span> + departmentName + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">'&#125;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="二、整合Mybatis操作数据库"><a href="#二、整合Mybatis操作数据库" class="headerlink" title="二、整合Mybatis操作数据库"></a>二、整合Mybatis操作数据库</h2><h3 id="1-配置数据源"><a href="#1-配置数据源" class="headerlink" title="1.配置数据源"></a>1.配置数据源</h3><ul>
<li>在application.properties中进行配置</li>
</ul>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.datasource.url</span>=<span class="string">jdbc:mysql://47.94.229.156:3306/spring_cache</span></span><br><span class="line"><span class="meta">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">spring.datasource.password</span>=<span class="string">123456</span></span><br><span class="line"><span class="comment"># spring.datasource.driver-class-name=com.mysql.jdbc.Driver(写不写都可以，会根据url判断）</span></span><br></pre></td></tr></table></figure>
<h3 id="2-使用注解版的Mybatis；"><a href="#2-使用注解版的Mybatis；" class="headerlink" title="2.使用注解版的Mybatis；"></a>2.使用注解版的Mybatis；</h3><ul>
<li>在主程序上用@MapperScan指定需要扫描的mapper接口所在的包</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@MapperScan</span>(<span class="string">"com.example.demo.mapper"</span>)</span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(DemoApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>与主程序同目录下创建mapper包</p>
</li>
<li><p>在mapper包下，建立相应的mapper（接口）<br><img alt="7e45b0e985912a04db0cb6a7a54e163e.png" data-src="https://gitee.com/danqing-hub/images/raw/master/7e45b0e985912a04db0cb6a7a54e163e.png" class="lazyload"></p>
<p><strong>首先对employee表操作</strong></p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">EmployeeMapper</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">"SELECT * FROM employee WHERE id = #&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Employee <span class="title">getEmpById</span><span class="params">(Integer id)</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Update</span>(<span class="string">"UPDATE employee SET lastName=#&#123;lastName&#125;,email=#&#123;email&#125;,gender=#&#123;gender&#125;,d_id=#&#123;dId&#125; WHERE id = #&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateEmp</span><span class="params">(Employee employee)</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Delete</span>(<span class="string">"DELETE FROM employee WHERE id = #&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteEmp</span><span class="params">(Integer id)</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Insert</span>(<span class="string">"INSERT INTO employee(lastName,email,gender,d_id VALUES (#&#123;lastName&#125;,#&#123;email&#125;,#&#123;gender&#125;,#&#123;dId&#125;))"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertEmployee</span><span class="params">(Employee employee)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-测试"><a href="#3-测试" class="headerlink" title="3.测试"></a>3.测试</h3><ul>
<li>在测试类中完成测试<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DemoApplicationTests</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    EmployeeMapper employeeMapper;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Employee empById = employeeMapper.getEmpById(<span class="number">1</span>);</span><br><span class="line">        System.out.println(empById);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
在控制台能看到如下：<br><img alt="ecce03b1b2ba8ab49015f9e14bcee36b.png" data-src="https://gitee.com/danqing-hub/images/raw/master/ecce03b1b2ba8ab49015f9e14bcee36b.png" class="lazyload"></li>
<li><em>这就说明数据库连接成功了*</em><br>由于数据库里的字段是d_id,javaBean里的是dId，没有指定使用驼峰命名规则，所以是查不到数据的。</li>
</ul>
<h3 id="4-业务层"><a href="#4-业务层" class="headerlink" title="4.业务层"></a>4.业务层</h3><ul>
<li>在主程序相同的目录下建立一个service包</li>
<li>建立EmployeeService类</li>
</ul>
<p><img alt="a3861a346b131fda49ae953344e13112.png" data-src="https://gitee.com/danqing-hub/images/raw/master/a3861a346b131fda49ae953344e13112.png" class="lazyload"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EmployeeService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    EmployeeMapper employeeMapper;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Employee <span class="title">getEmp</span><span class="params">(Integer id)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"查询"</span>+id+<span class="string">"号员工"</span>);</span><br><span class="line">        Employee empById = employeeMapper.getEmpById(id);</span><br><span class="line">        <span class="keyword">return</span> empById;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-表现层"><a href="#5-表现层" class="headerlink" title="5.表现层"></a>5.表现层</h3><ul>
<li>在主程序的同级目录下创建包controller</li>
<li>在controller包下创建EmployeeController类</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EmployeeController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    EmployeeService employeeService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/emp/&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Employee <span class="title">getEmp</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Integer id)</span>&#123;</span><br><span class="line">        Employee emp = employeeService.getEmp(id);</span><br><span class="line">        <span class="keyword">return</span> emp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="6-测试"><a href="#6-测试" class="headerlink" title="6.测试"></a>6.测试</h3><ul>
<li>运行<code>主程序</code></li>
<li>在浏览器输入<br><code>http://localhost:8080/emp/1</code></li>
</ul>
<p><img alt="f31a489f6651a8c504e0b74d149c9d27.png" data-src="https://gitee.com/danqing-hub/images/raw/master/f31a489f6651a8c504e0b74d149c9d27.png" class="lazyload"></p>
<p><strong>dId没有值的原因是没有开启驼峰命名规则</strong></p>
<h4 id="（1）开启驼峰命名规则"><a href="#（1）开启驼峰命名规则" class="headerlink" title="（1）开启驼峰命名规则"></a>（1）开启驼峰命名规则</h4><ul>
<li>在application.properties里加入</li>
</ul>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">mybatis.configuration.map-underscore-to-camel-case</span>=<span class="string">true</span></span><br></pre></td></tr></table></figure>
<p><img alt="9e5a1ee9edb166c869e76807ee6e28eb.png" data-src="https://gitee.com/danqing-hub/images/raw/master/9e5a1ee9edb166c869e76807ee6e28eb.png" class="lazyload"><br>这样就可以显示了</p>
<h1 id="TWO、快速体验缓存"><a href="#TWO、快速体验缓存" class="headerlink" title="TWO、快速体验缓存"></a>TWO、快速体验缓存</h1><h2 id="一、步骤"><a href="#一、步骤" class="headerlink" title="一、步骤"></a>一、步骤</h2><h3 id="1-开启基于注解的缓存"><a href="#1-开启基于注解的缓存" class="headerlink" title="1.开启基于注解的缓存"></a>1.开启基于注解的缓存</h3><ul>
<li>在主程序上加上基于注解的缓存<code>@EnableCaching</code></li>
</ul>
<p><img alt="8df2eb8b519f6a20d7c4be8518110960.png" data-src="https://gitee.com/danqing-hub/images/raw/master/8df2eb8b519f6a20d7c4be8518110960.png" class="lazyload"></p>
<h3 id="2-标注缓存注解即可"><a href="#2-标注缓存注解即可" class="headerlink" title="2.标注缓存注解即可"></a>2.标注缓存注解即可</h3><ul>
<li>在需要缓存的方法上加上下列相应的注解</li>
</ul>
<p><img alt="be97cad8afff1850ebe0710b1a825826.png" data-src="https://gitee.com/danqing-hub/images/raw/master/be97cad8afff1850ebe0710b1a825826.png" class="lazyload"></p>
<ul>
<li><p>在EmployeeService的方法上加上需要的注解<br><img alt="b0b751e8469c4741c298d12c397117db.png" data-src="https://gitee.com/danqing-hub/images/raw/master/b0b751e8469c4741c298d12c397117db.png" class="lazyload"></p>
</li>
<li><p><em>将方法的运行结果进行缓存；以后要是相同的数据，直接从缓存中获取，不用调用方法。*</em></p>
<ul>
<li>CacheManager管理多个Cache组件的，对缓存的真正的CRUD操作在Cache组件中，每一个缓存组件有自己唯一一个名字；</li>
<li>Cacheable的几个属性：<ul>
<li>cacheNames/value: 指定缓存组件的名字</li>
<li>key:缓存数据使用的key；可以用它来指定。默认是使用方法参数的值</li>
<li>编写可以适应SpEl表达式： #id；参数id的值</li>
<li>keyGenerator: key的生成器；可以自己指定key的生成器的组件id</li>
<li>key/keyGenerator 二选一使用</li>
<li>cacheManager：指定缓存管理器</li>
<li>condition：指定符合条件的情况下才缓存<code>eg:condition = &quot;#id&gt;0&quot;</code></li>
<li>unless：否定缓存：当unless指定的条件为true，方法的返回值就不会被缓存；（可以获取到结果进行判断）<br><code>eg:unless = &quot;#result==null&quot;</code></li>
<li>sync:是否使用异步模式</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="3-验证缓存生效"><a href="#3-验证缓存生效" class="headerlink" title="3.验证缓存生效"></a>3.验证缓存生效</h3><ul>
<li><p>为了方便显示效果，可以打印日志</p>
</li>
<li><p>在application.properties里添加相应的代码<code>logging.level.com.example.demo.mapper=debug</code></p>
</li>
<li><p>重启项目，清空控制器的打印，在浏览器输入<br><code>http://localhost:8080/emp/1</code><br>控制台如下<br><img alt="942c9d35365fb08037cdfd7d44fb60de.png" data-src="https://gitee.com/danqing-hub/images/raw/master/942c9d35365fb08037cdfd7d44fb60de.png" class="lazyload"><br>清空控制台，在浏览器刷新请求<br><img alt="942c9d35365fb08037cdfd7d44fb60de.png" data-src="https://gitee.com/danqing-hub/images/raw/master/942c9d35365fb08037cdfd7d44fb60de.png" class="lazyload"></p>
</li>
</ul>
<p><strong>此时可以看到控制台没有任何的输出，但是浏览器得到了数据，说明数据来源于缓存</strong></p>
<h2 id="二、缓存原理"><a href="#二、缓存原理" class="headerlink" title="二、缓存原理"></a>二、缓存原理</h2><ul>
<li>以@Cacheable为例：</li>
</ul>
<pre><code>*  Cacheable的执行流程：</code></pre><ul>
<li><p>1.方法执行前，先去查询Cache（缓存组件），按照cacheNames指定的名字获取；</p>
</li>
<li><p>（CacheManager先获取相应的缓存），第一次获取缓存，如果没有Cache组件就会自动创建</p>
</li>
<li><p>2.去Cache中查找缓存的内容，使用一个key，默认就是方法的参数；</p>
</li>
<li><p>key是按照某种策略生成的；默认是使用keyGenerator生成的，默认使用SimpleKeyGenerator生成key</p>
</li>
<li><p>SimpleKeyGenerator生成key的默认策略：</p>
<ul>
<li>如果没有参数：key = new SimpleKey();</li>
<li>如果有一个参数：key = 参数值</li>
<li>如果有多个参数：key = newSimplekey(params);</li>
</ul>
</li>
<li><p>3.没有查到缓存就调用目标方法</p>
</li>
<li><p>4.将目标方法返回的结果，放进缓存</p>
</li>
<li><p>总结：@Cacheable标注的方法执行之前先来检查缓存中有没有这个数据，默认按照参数的值作为</p>
</li>
<li><p>key去查询缓存，如果没有就运行方法，并将结果放进缓存</p>
</li>
<li><p>核心：</p>
<ul>
<li>1）、使用CacheManager【ConcurrentMapCacheManager】按照名字得到Cache【ConcurrentMapCache】组件</li>
<li>2）、key使用keyGenerator生成的，默认是SimpleKeyGenerator</li>
</ul>
</li>
</ul>
<h1 id="THREE、缓存注解"><a href="#THREE、缓存注解" class="headerlink" title="THREE、缓存注解"></a>THREE、缓存注解</h1><p><img alt="b24fc7165e849e41425758a92234a56c.png" data-src="https://gitee.com/danqing-hub/images/raw/master/b24fc7165e849e41425758a92234a56c.png" class="lazyload"></p>
<h2 id="一、-Cacheable"><a href="#一、-Cacheable" class="headerlink" title="一、@Cacheable"></a>一、@Cacheable</h2><p><strong>常用作查询</strong></p>
<h3 id="1-cacheNames-value"><a href="#1-cacheNames-value" class="headerlink" title="1.cacheNames/value"></a>1.cacheNames/value</h3><p> <strong>指定缓存组件的名字；指定将方法的返回结果放在哪个缓存中，是数组的方式，可以指定多个缓存</strong><br><img alt="a8cba4418bd87f1bba4051219001f7f2.png" data-src="https://gitee.com/danqing-hub/images/raw/master/a8cba4418bd87f1bba4051219001f7f2.png" class="lazyload"></p>
<h3 id="2-key-缓存数据使用的key"><a href="#2-key-缓存数据使用的key" class="headerlink" title="2.key:缓存数据使用的key"></a>2.key:缓存数据使用的key</h3><p><strong>可以用它来指定。默认是使用方法参数的值</strong></p>
<ul>
<li><p>编写可以使用SpEl表达式： #id；参数id的值；<br>#id相同的表示还有：#a0;  #p0; #root.args[0]<br>例子如下：<br><img alt="f5737d57b82ac91feaec47c2a392cc77.png" data-src="https://gitee.com/danqing-hub/images/raw/master/f5737d57b82ac91feaec47c2a392cc77.png" class="lazyload"></p>
<p><strong>key/keyGenerator 二选一使用</strong></p>
<h3 id="3-keyGenerator"><a href="#3-keyGenerator" class="headerlink" title="3.keyGenerator"></a>3.keyGenerator</h3><p><strong>key的生成器；可以自己指定key的生成器的组件id</strong></p>
</li>
<li><p><strong>（自定义key的生成策略）</strong> 在与主程序相同的目录下创建一个config包，包下建立一个MyCacheConfig类，用于配置缓存<br><img alt="8ea1faeedba43878de998fcd7edb2bb8.png" data-src="https://gitee.com/danqing-hub/images/raw/master/8ea1faeedba43878de998fcd7edb2bb8.png" class="lazyload"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyCacheConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span>(<span class="string">"myKeyGenerator"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> KeyGenerator <span class="title">keyGenerator</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> KeyGenerator()&#123;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> Object <span class="title">generate</span><span class="params">(Object o, Method method, Object... objects)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> method.getName()+<span class="string">"["</span>+ Arrays.asList(objects).toString()+<span class="string">"]"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>在缓存注解中如下操作<br><img alt="2fe37782b76bec83bc72031d6c2c991c.png" data-src="https://gitee.com/danqing-hub/images/raw/master/2fe37782b76bec83bc72031d6c2c991c.png" class="lazyload"></p>
<h3 id="4-cacheManager"><a href="#4-cacheManager" class="headerlink" title="4. cacheManager"></a>4. cacheManager</h3><p><strong>指定使用哪个缓存管理器</strong></p>
<h3 id="5-condition"><a href="#5-condition" class="headerlink" title="5.condition"></a>5.condition</h3></li>
<li><p><em>指定符合条件的情况下才缓存*</em><code>eg:condition = &quot;#id&gt;0&quot;</code><br><img alt="974ff7359f30a954093b12af0847717b.png" data-src="https://gitee.com/danqing-hub/images/raw/master/974ff7359f30a954093b12af0847717b.png" class="lazyload"></p>
<h3 id="6-unless"><a href="#6-unless" class="headerlink" title="6.unless"></a>6.unless</h3></li>
<li><p><em>否定缓存：当unless指定的条件为true，方法的返回值就不会被缓存；（可以获取到结果进行判断）*</em><br><img alt="6f486763e3eabf75cd23612053ed24cf.png" data-src="https://gitee.com/danqing-hub/images/raw/master/6f486763e3eabf75cd23612053ed24cf.png" class="lazyload"></p>
<p><code>eg:unless = &quot;#result==null&quot;</code></p>
<h3 id="7-sync"><a href="#7-sync" class="headerlink" title="7.sync"></a>7.sync</h3></li>
<li><p><em>是否使用异步模式*</em><br><code>sync=&quot;true&quot;</code></p>
</li>
<li><p><em>注意：异步模式下unless不支持*</em></p>
</li>
</ul>
<h2 id="二、-CachePut"><a href="#二、-CachePut" class="headerlink" title="二、@CachePut"></a>二、@CachePut</h2><p><strong>既调用方法，又更新缓存数据</strong><br><strong>修改了数据库的某个数据，同时更新缓存</strong><br><strong>执行逻辑：</strong></p>
<ul>
<li>1.先调用目标方法</li>
<li>2.将目标方法的结果缓存起来<h3 id="1-在需要的方法上添加注解"><a href="#1-在需要的方法上添加注解" class="headerlink" title="1.在需要的方法上添加注解"></a>1.在需要的方法上添加注解</h3></li>
</ul>
<p><strong>在EmployeeService类中添加如下代码</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@CachePut</span>(<span class="string">"emp"</span>)</span><br><span class="line">   <span class="function"><span class="keyword">public</span> Employee <span class="title">UpdateEmp</span><span class="params">(Employee employee)</span></span>&#123;</span><br><span class="line">       System.out.println(<span class="string">"updateEmp:"</span>+employee);</span><br><span class="line">       employeeMapper.updateEmp(employee);</span><br><span class="line">       <span class="keyword">return</span> employee;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-测试"><a href="#2-测试" class="headerlink" title="2.测试"></a>2.测试</h3><p><strong>修改查询方法，让它按照默认</strong></p>
<p><img alt="83cd5c6aeeff7cd9cb22f1aa9138d0c4.png" data-src="https://gitee.com/danqing-hub/images/raw/master/83cd5c6aeeff7cd9cb22f1aa9138d0c4.png" class="lazyload"></p>
<h4 id="（1）查询1号员工，并把查询的结果放到缓存中"><a href="#（1）查询1号员工，并把查询的结果放到缓存中" class="headerlink" title="（1）查询1号员工，并把查询的结果放到缓存中"></a>（1）查询1号员工，并把查询的结果放到缓存中</h4><ul>
<li>启动项目，在浏览器中输入<code>http://localhost:8080/emp/1</code><br>  浏览器中返回的数据如下：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;id&quot;:1,&quot;lastName&quot;:&quot;1&quot;,&quot;email&quot;:&quot;1&quot;,&quot;gender&quot;:1,&quot;dId&quot;:1&#125;</span><br></pre></td></tr></table></figure>
<p>控制台打印查询语句</p>
<p><img alt="645d678d8a8550f3e5f11b82f386c4d9.png" data-src="https://gitee.com/danqing-hub/images/raw/master/645d678d8a8550f3e5f11b82f386c4d9.png" class="lazyload"></p>
<h4 id="（2）再次查询1号员工"><a href="#（2）再次查询1号员工" class="headerlink" title="（2）再次查询1号员工"></a>（2）再次查询1号员工</h4><ul>
<li><p>清除控制台，再次在浏览器中输入<code>http://localhost:8080/emp/1</code><br>浏览器中依然返回相同的数据：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;id&quot;:1,&quot;lastName&quot;:&quot;1&quot;,&quot;email&quot;:&quot;1&quot;,&quot;gender&quot;:1,&quot;dId&quot;:1&#125;</span><br></pre></td></tr></table></figure></li>
<li><p><em>控制台没有打印任何信息，说明数据来源于缓存*</em></p>
<h4 id="（3）更新1号员工"><a href="#（3）更新1号员工" class="headerlink" title="（3）更新1号员工"></a>（3）更新1号员工</h4></li>
<li><p>在浏览器中输入<code>http://localhost:8080/emp?id=1&amp;lastName=zhangsan&amp;gender=0</code></p>
</li>
<li><p>控制台打印信息如下</p>
</li>
</ul>
<p><img alt="bf64aa4e2b48991f3762e6bb255b875d.png" data-src="https://gitee.com/danqing-hub/images/raw/master/bf64aa4e2b48991f3762e6bb255b875d.png" class="lazyload"></p>
<p><strong>说明【lastName=zhangsan,gender=0】</strong></p>
<h4 id="（4）第三次查询1号员工"><a href="#（4）第三次查询1号员工" class="headerlink" title="（4）第三次查询1号员工"></a>（4）第三次查询1号员工</h4><ul>
<li>清除控制台，在浏览器输入<code>http://localhost:8080/emp/1</code></li>
<li>查询出来的数据如下：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;id&quot;:1,&quot;lastName&quot;:&quot;1&quot;,&quot;email&quot;:&quot;1&quot;,&quot;gender&quot;:1,&quot;dId&quot;:1&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>控制台没有打印任何信息</li>
</ul>
<p><strong>查出来的数据是更新前的数据，更新后的数据没有查到，为什么没有查到更新后的数据呢？？？</strong></p>
<h3 id="3-为什么没有查到更新后的数据？？？"><a href="#3-为什么没有查到更新后的数据？？？" class="headerlink" title="3.为什么没有查到更新后的数据？？？"></a>3.为什么没有查到更新后的数据？？？</h3><ul>
<li>查询1号员工时，往缓存放的数据是按照key-value放的，@Cacheable默认使用方法参数的值为key，这里的就是id，也就是传入的1，key：1 ； value：[id”:1,”lastName”:”1”,”email”:”1”,”gender”:1,”dId”:1]</li>
<li>更新了一个员工后，调用了@CachePut，更新了员工，更新后的员工信息放到了缓存中，为什么没有取到？因为默认指定的key是不相同的，那样就没法在查询的时候查到了。它用的key为传入的employee对象，value为返回的employee对象，即：<br>key：传入的employee对象   value：返回的employee对象</li>
</ul>
<p><strong>可见要想查出更新后的员工，更新的key和查询的key应该一致</strong></p>
<h3 id="4-解决方法"><a href="#4-解决方法" class="headerlink" title="4.解决方法"></a>4.解决方法</h3><h4 id="（1）更新的key和查询的key应该一致"><a href="#（1）更新的key和查询的key应该一致" class="headerlink" title="（1）更新的key和查询的key应该一致"></a>（1）更新的key和查询的key应该一致</h4><ul>
<li><p>因为查询的时候用的是参数id，更新的时候也可以用id作为key</p>
</li>
<li><p>只需要给@CachePut指定key=<code>“#employee.id”</code><br><img alt="697961dc51c15c2a38a615e7610cd162.png" data-src="https://gitee.com/danqing-hub/images/raw/master/697961dc51c15c2a38a615e7610cd162.png" class="lazyload"></p>
</li>
</ul>
<h4 id="（2）也可以用返回值"><a href="#（2）也可以用返回值" class="headerlink" title="（2）也可以用返回值"></a>（2）也可以用返回值</h4><ul>
<li>@CachePut是方法执行完之后，在往缓存放东西，可以从返回值中获取相应的值作为key，key=<code>#result.id</code></li>
</ul>
<p><img alt="8d9be096f68d0e4043ed37f0d9fef11b.png" data-src="https://gitee.com/danqing-hub/images/raw/master/8d9be096f68d0e4043ed37f0d9fef11b.png" class="lazyload"></p>
<h3 id="5-再次测试"><a href="#5-再次测试" class="headerlink" title="5.再次测试"></a>5.再次测试</h3><h4 id="（1）查询1号员工"><a href="#（1）查询1号员工" class="headerlink" title="（1）查询1号员工"></a>（1）查询1号员工</h4><ul>
<li>重新启动项目，在浏览器中输入<code>http://localhost:8080/emp/1</code><br>得到结果如下：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;id&quot;:1,&quot;lastName&quot;:&quot;zhangsan&quot;,&quot;email&quot;:null,&quot;gender&quot;:0,&quot;dId&quot;:null&#125;</span><br></pre></td></tr></table></figure>
<img alt="727fb67e59e9ed4f4c51995d66aa13e8.png" data-src="https://gitee.com/danqing-hub/images/raw/master/727fb67e59e9ed4f4c51995d66aa13e8.png" class="lazyload"></li>
</ul>
<h4 id="（2）再次查询1号员工-1"><a href="#（2）再次查询1号员工-1" class="headerlink" title="（2）再次查询1号员工"></a>（2）再次查询1号员工</h4><ul>
<li><p>在浏览器中输入<code>http://localhost:8080/emp/1</code><br>得到的结果不变，控制台没有再次输出，可以知道是从缓存中获取的数据</p>
<h4 id="（3）更新1号员工-1"><a href="#（3）更新1号员工-1" class="headerlink" title="（3）更新1号员工"></a>（3）更新1号员工</h4></li>
<li><p>在浏览器中输入<code>http://localhost:8080/emp?id=1&amp;lastName=张三&amp;gender=1&amp;email=123456@qq.com</code></p>
</li>
<li><p>浏览器中的返回结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;id&quot;:1,&quot;lastName&quot;:&quot;张三&quot;,&quot;email&quot;:&quot;123456@qq.com&quot;,&quot;gender&quot;:1,&quot;dId&quot;:null&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>控制台的结果如下：</p>
</li>
</ul>
<p><img alt="38a221720f1de7b4fc1902a2fefe38f2.png" data-src="https://gitee.com/danqing-hub/images/raw/master/38a221720f1de7b4fc1902a2fefe38f2.png" class="lazyload"></p>
<h4 id="（4）第三次查询1号员工-1"><a href="#（4）第三次查询1号员工-1" class="headerlink" title="（4）第三次查询1号员工"></a>（4）第三次查询1号员工</h4><ul>
<li>在浏览器中输入<code>http://localhost:8080/emp/1</code></li>
<li>浏览器中返回值如下：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;id&quot;:1,&quot;lastName&quot;:&quot;张三&quot;,&quot;email&quot;:&quot;123456@qq.com&quot;,&quot;gender&quot;:1,&quot;dId&quot;:null&#125;</span><br></pre></td></tr></table></figure></li>
<li><em>控制台中没有任何打印，说明是从缓存中查询的数据*</em></li>
</ul>
<h2 id="三、-CacheEvict"><a href="#三、-CacheEvict" class="headerlink" title="三、@CacheEvict"></a>三、@CacheEvict</h2><p>常用于缓存清除</p>
<h3 id="1-在-EmployeeService里添加相应的方法"><a href="#1-在-EmployeeService里添加相应的方法" class="headerlink" title="1.在 EmployeeService里添加相应的方法"></a>1.在 EmployeeService里添加相应的方法</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@CacheEvict</span>(value = <span class="string">"emp"</span>,key = <span class="string">"#id"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteEmp</span><span class="params">(Integer id)</span></span>&#123;</span><br><span class="line">      System.out.println(<span class="string">"deleteEmp"</span>+id);</span><br><span class="line">      <span class="comment">//employeeMapper.deleteEmp(id);//先不执行删除方法</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-在-EmployeeController里添加相应的方法"><a href="#2-在-EmployeeController里添加相应的方法" class="headerlink" title="2.在 EmployeeController里添加相应的方法"></a>2.在 EmployeeController里添加相应的方法</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"/delemp"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">deleteEmp</span><span class="params">(Integer id)</span></span>&#123;</span><br><span class="line">        employeeService.deleteEmp(id);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-测试-1"><a href="#3-测试-1" class="headerlink" title="3.测试"></a>3.测试</h3><ul>
<li>重新启动项目，在浏览器中输入<code>http://localhost:8080/emp/1</code>，可以查询到相应的信息，控制台打印查询语句。</li>
<li>再次在浏览器中输入<code>http://localhost:8080/emp/1</code>，可以看到浏览器中查到信息，但是控制台没有打印，说明信息来自缓存</li>
<li>在浏览器中输入<code>http://localhost:8080/delemp?id=1</code><br>浏览器返回success<br>控制台返回如下：</li>
</ul>
<p><img alt="1d81b28f24f74bdb73ca318a94794685.png" data-src="https://gitee.com/danqing-hub/images/raw/master/1d81b28f24f74bdb73ca318a94794685.png" class="lazyload"></p>
<ul>
<li>再次在浏览器输入<code>http://localhost:8080/emp/1</code>，浏览器中返回为空，控制台打印如下：</li>
</ul>
<p><img alt="4e76fd301ce7eed71c36b7b0d99d5734.png" data-src="https://gitee.com/danqing-hub/images/raw/master/4e76fd301ce7eed71c36b7b0d99d5734.png" class="lazyload"></p>
<p>说明删除了数据库里的同时删除了缓存里的数据</p>
<h3 id="4-属性"><a href="#4-属性" class="headerlink" title="4.属性"></a>4.属性</h3><h4 id="（1）key"><a href="#（1）key" class="headerlink" title="（1）key"></a>（1）key</h4><ul>
<li>指定清除的数据（默认为参数的值）</li>
</ul>
<h4 id="（2）allEntries"><a href="#（2）allEntries" class="headerlink" title="（2）allEntries"></a>（2）allEntries</h4><ul>
<li>是不是删除value值下的所有缓存数据</li>
<li>既然全都删除，那就不需要指定key</li>
</ul>
<p><img alt="573c77f39fa21d68a56478601925922d.png" data-src="https://gitee.com/danqing-hub/images/raw/master/573c77f39fa21d68a56478601925922d.png" class="lazyload"></p>
<p>如图，就是删除emp的所有缓存</p>
<h4 id="（3）beforeInvocation"><a href="#（3）beforeInvocation" class="headerlink" title="（3）beforeInvocation"></a>（3）beforeInvocation</h4><ul>
<li>缓存的清除是否在执行方法之前执行（默认是在方法执行之后执行）</li>
</ul>
<p><strong>如果在方法执行之前清空缓存，那么在方法出错的时候，方法没有执行，但是缓存会清空</strong></p>
<h2 id="四、-Caching"><a href="#四、-Caching" class="headerlink" title="四、@Caching"></a>四、@Caching</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target</span>(&#123;ElementType.TYPE, ElementType.METHOD&#125;)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Inherited</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Caching &#123;</span><br><span class="line"></span><br><span class="line">	Cacheable[] cacheable() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">	CachePut[] put() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">	CacheEvict[] evict() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>可以看到这是一个组合注解，可以指定多个缓存规则，用于复杂情况的缓存操作</strong></p>
<h3 id="1-在EmployeeService中写如下方法"><a href="#1-在EmployeeService中写如下方法" class="headerlink" title="1.在EmployeeService中写如下方法"></a>1.在EmployeeService中写如下方法</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Caching</span>(</span><br><span class="line">            cacheable = &#123;</span><br><span class="line">                    <span class="meta">@Cacheable</span>(value = <span class="string">"emp"</span>,key = <span class="string">"#lastName"</span>)</span><br><span class="line">                &#125;,</span><br><span class="line">            put = &#123;</span><br><span class="line">                  <span class="meta">@CachePut</span>(value = <span class="string">"emp"</span>,key = <span class="string">"#result.id"</span>),</span><br><span class="line">                    <span class="meta">@CachePut</span>(value = <span class="string">"emp"</span>,key = <span class="string">"#result.email"</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            )</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Employee <span class="title">getEmpByLastName</span><span class="params">(String lastName)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> employeeMapper.getEmpByLastName(lastName);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>可以看到用了这个组合注解，可以一次查询把数据放到很多key里</li>
</ul>
<h3 id="2-在EmployeeController中添加如下方法"><a href="#2-在EmployeeController中添加如下方法" class="headerlink" title="2.在EmployeeController中添加如下方法"></a>2.在EmployeeController中添加如下方法</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"/emp/lastname/&#123;lastName&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Employee <span class="title">getEmpByLastName</span><span class="params">(@PathVariable(<span class="string">"lastName"</span>)</span> String lastName)</span>&#123;</span><br><span class="line">        Employee emp = employeeService.getEmpByLastName(lastName);</span><br><span class="line">        <span class="keyword">return</span> emp;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-在EmployeeMapper中写如下方法"><a href="#3-在EmployeeMapper中写如下方法" class="headerlink" title="3.在EmployeeMapper中写如下方法"></a>3.在EmployeeMapper中写如下方法</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Select</span>(<span class="string">"SELECT * FROM employee WHERE lastName = #&#123;lastName&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Employee <span class="title">getEmpByLastName</span><span class="params">(String lastName)</span></span>;</span><br></pre></td></tr></table></figure>
<h3 id="4-测试"><a href="#4-测试" class="headerlink" title="4.测试"></a>4.测试</h3><ul>
<li>先在数据库添加一些数据用于测试</li>
</ul>
<p><img alt="3ae30c5b9ebf6dfd6d8995de8674c975.png" data-src="https://gitee.com/danqing-hub/images/raw/master/3ae30c5b9ebf6dfd6d8995de8674c975.png" class="lazyload"></p>
<ul>
<li>运行项目，在浏览器中输入<code>http://localhost:8080/emp/lastname/张三</code><br>浏览器中返回数据：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;id&quot;:1,&quot;lastName&quot;:&quot;张三&quot;,&quot;email&quot;:&quot;111&quot;,&quot;gender&quot;:1,&quot;dId&quot;:1&#125;</span><br></pre></td></tr></table></figure>
控制台打印查询日志</li>
</ul>
<p><img alt="d4be5768d674d64d0f5229c036dd9afa.png" data-src="https://gitee.com/danqing-hub/images/raw/master/d4be5768d674d64d0f5229c036dd9afa.png" class="lazyload"></p>
<ul>
<li><p>在浏览器中输入<code>http://localhost:8080/emp/1</code>，可以看到浏览器中返回数据相同，但是控制台并没有任何打印，所以数据来源于缓存，这样就实现了查询一次数据库，把数据放到多个key的目的</p>
</li>
<li><p>同样的，如果我们再写一个根据email查询的方法，执行完上面的流程，也是可以在缓存中拿到数据的（这里没写根据email查询的，就不再测试了）</p>
</li>
</ul>
<p><strong>注意：虽然已经根据lastName查询出来数据了，这个时候如果我再次根据lastName查询，还是会查询数据库的，因为有@CachePut，后面的方法一定会执行的，执行方法，就会查询数据库</strong></p>
<p><img alt="c291d9de66bc795b5e63cf5f325f849d.png" data-src="https://gitee.com/danqing-hub/images/raw/master/c291d9de66bc795b5e63cf5f325f849d.png" class="lazyload"></p>
<h2 id="五、-CacheConfig"><a href="#五、-CacheConfig" class="headerlink" title="五、@CacheConfig"></a>五、@CacheConfig</h2><h3 id="1-cacheName"><a href="#1-cacheName" class="headerlink" title="1.cacheName"></a>1.cacheName</h3><p><strong>根据上面的学习我们可以发现，每一个注解里面都要指定<code>value=“emp”</code>这样就会增加工作量，我们可以在类上加上@CacheConfig，用属性cacheName指定，格式如下：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@CacheConfig</span>(cacheNames = <span class="string">"emp"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EmployeeService</span> </span>&#123;</span><br></pre></td></tr></table></figure>

<ul>
<li>这里指定了cacheName，下面的所有缓存注解都不需要指定cacheName或者value了</li>
</ul>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined" target="_blank" rel="noopener">Danqing</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://yoursite.com/2020/04/13/SpringBoot%E7%BC%93%E5%AD%98/">http://yoursite.com/2020/04/13/SpringBoot%E7%BC%93%E5%AD%98/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://yoursite.com">DanqingBlog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%BC%93%E5%AD%98/">缓存    </a></div><div class="post_share"><div class="social-share" data-image="https://gitee.com/danqing-hub/images/raw/master/springboot.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button"><i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/wechat.jpg"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/alipay.jpg"><div class="post-qr-code__desc">支付宝</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2020/04/17/%E7%8F%AD%E7%BA%A7%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F(SSM+LayUI)/"><img class="prev_cover lazyload" data-src="https://gitee.com/danqing-hub/images/raw/master/layui.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">上一篇</div><div class="prev_info"><span>班级管理系统(SSM+LayUI)</span></div></a></div><div class="next-post pull_right"><a href="/2020/02/07/ajax%E6%88%90%E5%8A%9F%E8%AF%B7%E6%B1%82%E5%88%B0%E5%90%8E%E5%8F%B0%EF%BC%8C%E4%BD%86%E6%98%AF%E5%89%8D%E7%AB%AF%E6%8A%A5404%E9%94%99%E8%AF%AF/"><img class="next_cover lazyload" data-src="https://gitee.com/danqing-hub/images/raw/master/ajax.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>ajax成功请求到后台，但是前端报404错误</span></div></a></div></nav><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div id="lv-container" data-id="city" data-uid="MTAyMC80OTY3MS8yNjE2Mg=="><script>(function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
})(document, 'script');</script></div></div></div></div><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2020 By Danqing</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">字</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.15/dist/snackbar.min.js"></script><script id="ribbon_piao" mobile="true" src="/js/third-party/piao.js"></script><script id="canvas_nest" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="true" src="/js/third-party/canvas-nest.js"></script><script src="/js/third-party/activate-power-mode.js"></script><script>POWERMODE.colorful = true; // make power mode colorful
POWERMODE.shake = true; // turn off shake
document.body.addEventListener('input', POWERMODE);
</script><script src="/js/tw_cn.js"></script><script>translateInitilization()
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script></body></html>